<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>El Tour Trike Dashboard</title>
    
    <link rel="icon" type="image/x-icon" href="images/favicon.ico">
    <link rel="stylesheet" href="/style.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gauge.js/1.2.1/gauge.min.js"></script>
    <script type="module" src="telemetry.js"></script>
    <!--<script type="module" src="map.js"></script>-->
    <!--<script type="module" src="graph.js"></script>-->

       
    </script>
  </head> 


<body>
    <!-- Startup Overlay -->
    <div id="bootOverlay">
      <pre id="bootLog">[00:00] Initializing El Tour Trike Dashboard...</pre>
    </div>

    
    <header class="dashboard-header">
      <h1>El Tour Trike Dashboard</h1>
    </header>

    
    <div class="dashboard-grid">
        
        <div id="cadence" class="gauge-container fade-in">
        <h2>Cadence</h2>
        <canvas id="cadenceGauge"></canvas>
        <div id="cadenceValue" class="gauge-value">0 RPM</div>
        </div>

        <div id="datatree" class="gauge-container fade-in">
          <h2>Telemetry Data</h2> <br>
          <img src="images/telemetry4.png" alt="Telemetry Icon" style="width:20px;height:20px;vertical-align:middle;"><br>
          <pre id="dataTree" style="text-align:center; font-size:12px; color:#5aede5;">Present Elevation ......... 2500</pre>
          <pre id="dataTree" style="text-align:center; font-size:12px; color:#5aede5;">Elevation Change .......... +100</pre>
          <pre id="dataTree" style="text-align:center; font-size:12px; color:#5aede5;">Trike System Sync ......... Good</pre>
          <pre id="dataTree" style="text-align:center; font-size:12px; color:#5aede5;">Last Transmission ......... 10 seconds ago</pre>
        </div>    

        <div id="speed" class="gauge-container fade-in">
        <h2>Speed</h2>
        <canvas id="speedGauge"></canvas>
        <div id="speedValue" class="gauge-value">0 MPH</div>
        </div>
    </div>
    <div class="map-container-wrapper fade-in">
       <div id="map" class="map-container">
        <h2>Location</h2>
        <div id="mapDisplay"></div>
        </div>
    </div>
   

    <div id="elevation" class="graph-container fade-in">
        <h2>Elevation</h2>
        <canvas id="elevationGraph"></canvas>
    </div>

    <script>
    const bootLog = document.getElementById('bootLog');
    const logs = [
      "[00:01] Syncing telemetry...",
      "[00:02] Calibrating gauges...",
      "[00:03] Loading map data...",
      "[00:04] System ready."
    ];

    let i = 0;
    const interval = setInterval(() => {
      bootLog.textContent = logs[i];
      i++;
      if (i === logs.length) {
        clearInterval(interval);
        document.getElementById('bootOverlay').style.display = 'none';

        // Fade in dashboard sections
        document.querySelectorAll('.fade-in').forEach((el, idx) => {
          setTimeout(() => el.classList.add('visible'), idx * 500);
    });

        // Optional: sweep gauges if initialized
        if (window.cadenceGauge) sweepGauge(cadenceGauge, 100);
        if (window.speedGauge) sweepGauge(speedGauge, 40);
      }
    }, 1000);

    function sweepGauge(gauge, maxValue) {
      let value = 0;
      const interval = setInterval(() => {
        cadGauge.set(value);
        speGauge.set(value);
        value += 5;
        if (value > maxValue) {
          clearInterval(interval);
          setTimeout(() => {
            cadGauge.set(0);
            speGauge.set(0);
          }, 500);
        }
      }, 50);
    }
  </script>
   
</body>

</html>
